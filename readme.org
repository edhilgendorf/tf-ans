#+TITLE: Notes

* Install Terraform :terraform:install:
https://www.terraform.io/downloads.html
* Configure AWS :aws:
- Register account: https://portal.aws.amazon.com/gp/aws/developer/registration/index.html
** Setup AWS CLI :cli:install:
- https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2-linux.html
** Create IAM User and Policies :iam:
- IAM: https://console.aws.amazon.com/iam/home
- Polcies: https://console.aws.amazon.com/iamv2/home?#/policiesC
- IAM User: https://console.aws.amazon.com/iam/home#/users$new?step=details
  + programmatic (non-console)
  + attach existing policy
- Add user to ~/.aws/credentials~ as a profile:
 #+begin_src
 [default]
 aws_access_key=XXX
 aws_secret_access_key=XXX

 [tf_user]
 aws_access_key=XXX
 aws_secret_access_key=XXX
 #+end_src
- Add root user as default, or create IAM admin:
  https://console.aws.amazon.com/iam/home?region=us-east-1#/security_credentials$access_key
*** base policy
[[./policies/base.json]]
* Configure Terraform Cloud
- Regsiter account: https://app.terraform.io/signup/account?utm_source=terraform_io&utm_content=terraform_cloud_top_nav
** Setup Terraform Cloud State
- Create an organization
- Create a Workspace from VCS Repository
- Create a token and save in ~~/.terraform.d/credentials.tfrc.json~
  - https://app.terraform.io/app/settings/tokens
- Create Terraform Backend config locally:
  #+begin_src json
  terraform {
    backend "remote" {
      organization = "hilgendorfdotme"
      workspaces {
        name ="tf-ans"
      }
    }
  #  required_version = ">= 0.14.9"
  }
  #+end_src
- Add access keys to Terraform Cloud
  - https://app.terraform.io/app/hilgendorfdotme/workspaces/tf-ans/variables
- Initialize your environment ~terraform init~
* test
